# Description: Zsh shell completion script for yarn
# Author: Mina Demian
# E-mail: mina@minademian.com
# License: MIT
# Version: 1.0.3
# Last updated: 2025-11-08

#compdef yarn

if ! (( ${+functions[complete]} )); then
    complete() { : ; }
fi

# Find bash completion via Homebrew's standard location
if command -v brew &>/dev/null; then
    local bash_completion="$(brew --prefix)/etc/bash_completion.d/yarn"
    if [[ -f "$bash_completion" ]]; then
        autoload -U +X bashcompinit && bashcompinit
        source "$bash_completion"
    else
        return 1
    fi
else
    return 1
fi

_compadd() { 
    [[ -n "${compstate}" ]] && compadd -- ${=1}
}

_yarn() {
    local -a COMP_WORDS COMPREPLY
    local COMP_CWORD
    
    COMP_WORDS=("${words[@]}")
    COMP_CWORD=$((CURRENT - 1))
    
    _yarn_completion_main
    
    (( ${#COMPREPLY[@]} )) && compadd -a COMPREPLY
}

[[ -v functions[compdef] ]] && compdef _yarn yarn